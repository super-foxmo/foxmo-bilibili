<?xml version="1.0" encoding="UTF8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--namespace绑定一个对应的Dao/Mapper接口-->
<mapper namespace="com.foxmo.bilibili.mapper.VideoMapper">
    <insert id="insertVideo" parameterType="com.foxmo.bilibili.domain.Video" useGeneratedKeys="true" keyProperty="id">
        insert into
            t_video(
                id,
                userId,
                url,
                thumbnail,
                title,
                `type`,
                duration,
                area,
                description,
                createTime
        )
        values(
               #{id},
               #{userId},
               #{usl},
               #{thumbnail},
               #{title},
               #{type},
               #{duration},
               #{area},
               #{description},
               #{createTime}
              )
    </insert>

    <insert id="batchAddVideoTags" parameterType="com.foxmo.bilibili.domain.VideoTag">
        insert into
            t_video_tag(
                videoId,
                tagId,
                createTime
        )
        values
        <foreach collection="videoTagList" item="videoTag" separator=",">
            (
                #{videoTag.videoId},
                #{videoTag.tagId},
                #{videoTag.createTime}
            )
        </foreach>
    </insert>

    <select id="pageCountVideos" parameterType="map" resultType="java.lang.Integer">
        select
            count (1)
        from
            t_video
        <where>
            <if test="area != null and area != '' ">
                area = #{area}
            </if>
        </where>
    </select>
    
    <select id="pageListVideos" parameterType="map" resultType="com.foxmo.bilibili.domain.Video">
        select
            *
        from
            t_video
        <where>
            <if test="area != null and area != '' ">
                area = #{area}
            </if>
        </where>
        order by id desc
        limit #{start}, #{size}
    </select>
</mapper>